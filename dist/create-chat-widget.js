var ChatWidget;(()=>{"use strict";var t={d:(e,o)=>{for(var a in o)t.o(o,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:o[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{createWidget:()=>s,stopNotification:()=>r});const o="BFimg4nhhiga2UkChbE_luhDsQoQL1_82igq9D9--RMSSVVOsCC1kd4Rc6V2vDcq7Bh0feKWxcvpZpY8eBr4Vhg";let a;async function n(t){const e=await async function(){if("serviceWorker"in navigator){return await navigator.serviceWorker.register("/360-sw.js")}console.log("[chat-embed] No service worker available")}();console.log(e),e&&await async function(t,e){const n=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i(o)});a=n;const s={"content-type":"application/json",Authorization:`Bearer ${e}`},r=await fetch("https://auth.swivelsoftware.asia/api/notification/subscribe",{method:"POST",body:JSON.stringify(n),headers:s});r.ok&&console.dir(r)}(e,t),console.log("[chat-embed] service worker registered")}function i(t){const e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),o=window.atob(e),a=new Uint8Array(o.length);for(let t=0;t<o.length;++t)a[t]=o.charCodeAt(t);return a}async function s(t,e){const o=await async function(t,e){const o=await fetch("https://auth.swivelsoftware.asia/auth/local/login",{method:"POST",headers:{"x-system":"360uat","Content-Type":"application/json"},body:JSON.stringify({username:t,password:e,rememberMe:!1})});return(await o.json()).accessToken}(t,e);localStorage.setItem("360-accessToken",o),function(t){const e=document.getElementById("chat-container"),o=document.createElement("swivel-chat-widget");o.setAttribute("id","swivel-chat-widget"),o.setAttribute("name",JSON.stringify(["Main"])),o.setAttribute("token",t),o.setAttribute("system","360uat"),o.setAttribute("uat","true"),o.setAttribute("propdata",JSON.stringify({full:!1,button:!0,right:!1,system:"360uat",entityType:"customer",entityKey:"DEV",entityReferenceKey:"Development Team",hasPublicChatroom:!0,extraChatrooms:[],maxShowChatroom:4,leftOffset:0,rightOffset:0})),o.setAttribute("injectCss",e.id);const a=document.createElement("style");a.innerHTML="",e.appendChild(o),o.shadowRoot&&(console.log(a),o.shadowRoot.appendChild(a)),document.body.addEventListener("swivel-widget-loaded",(()=>{o.shadowRoot&&o.shadowRoot.appendChild(a)}))}(o),await n(o)}async function r(){!async function(){const t={"content-type":"application/json",Authorization:`Bearer ${localStorage.getItem("360-accessToken")}`},e=await fetch("https://auth.swivelsoftware.asia/api/notification/unsubscribe",{method:"POST",body:JSON.stringify(a),headers:t});e.ok&&console.dir(e)}()}ChatWidget=e})();